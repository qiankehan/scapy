#! /usr/bin/env python

# This file is part of Scapy
# Scapy is free software: you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation, either version 2 of the License, or
# any later version.
#
# Scapy is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with Scapy. If not, see <http://www.gnu.org/licenses/>.

# scapy.contrib.description = ICMP Extensions
# scapy.contrib.status = loads

from __future__ import absolute_import
import scapy
from scapy.packet import Packet, bind_layers
from scapy.fields import *
from scapy.layers.inet import IP, ICMP
from scapy.layers.inet6 import IP6Field
from scapy.error import warning
from scapy.contrib.mpls import MPLS
import scapy.modules.six as six
procedure_dict = {1: "CONNECT_OPEN",
                  2: "CONNECT_CLOSE",
                  3: "CONNECT_GET_TYPE",
                  4: "CONNECT_GET_VERSION",
                  5: "CONNECT_GET_MAX_VCPUS",
                  6: "NODE_GET_INFO",
                  7: "CONNECT_GET_CAPABILITIES",
                  8: "DOMAIN_ATTACH_DEVICE",
                  9: "DOMAIN_CREATE",
                  10: "DOMAIN_CREATE_XML",
                  11: "DOMAIN_DEFINE_XML",
                  12: "DOMAIN_DESTROY",
                  13: "DOMAIN_DETACH_DEVICE",
                  14: "DOMAIN_GET_XML_DESC",
                  15: "DOMAIN_GET_AUTOSTART",
                  16: "DOMAIN_GET_INFO",
                  17: "DOMAIN_GET_MAX_MEMORY",
                  18: "DOMAIN_GET_MAX_VCPUS",
                  19: "DOMAIN_GET_OS_TYPE",
                  20: "DOMAIN_GET_VCPUS",
                  21: "CONNECT_LIST_DEFINED_DOMAINS",
                  22: "DOMAIN_LOOKUP_BY_ID",
                  23: "DOMAIN_LOOKUP_BY_NAME",
                  24: "DOMAIN_LOOKUP_BY_UUID",
                  25: "CONNECT_NUM_OF_DEFINED_DOMAINS",
                  26: "DOMAIN_PIN_VCPU",
                  27: "DOMAIN_REBOOT",
                  28: "DOMAIN_RESUME",
                  29: "DOMAIN_SET_AUTOSTART",
                  30: "DOMAIN_SET_MAX_MEMORY",
                  31: "DOMAIN_SET_MEMORY",
                  32: "DOMAIN_SET_VCPUS",
                  33: "DOMAIN_SHUTDOWN",
                  34: "DOMAIN_SUSPEND",
                  35: "DOMAIN_UNDEFINE",
                  36: "CONNECT_LIST_DEFINED_NETWORKS",
                  37: "CONNECT_LIST_DOMAINS",
                  38: "CONNECT_LIST_NETWORKS",
                  39: "NETWORK_CREATE",
                  40: "NETWORK_CREATE_XML",
                  41: "NETWORK_DEFINE_XML",
                  42: "NETWORK_DESTROY",
                  43: "NETWORK_GET_XML_DESC",
                  44: "NETWORK_GET_AUTOSTART",
                  45: "NETWORK_GET_BRIDGE_NAME",
                  46: "NETWORK_LOOKUP_BY_NAME",
                  47: "NETWORK_LOOKUP_BY_UUID",
                  48: "NETWORK_SET_AUTOSTART",
                  49: "NETWORK_UNDEFINE",
                  50: "CONNECT_NUM_OF_DEFINED_NETWORKS",
                  51: "CONNECT_NUM_OF_DOMAINS",
                  52: "CONNECT_NUM_OF_NETWORKS",
                  53: "DOMAIN_CORE_DUMP",
                  54: "DOMAIN_RESTORE",
                  55: "DOMAIN_SAVE",
                  56: "DOMAIN_GET_SCHEDULER_TYPE",
                  57: "DOMAIN_GET_SCHEDULER_PARAMETERS",
                  58: "DOMAIN_SET_SCHEDULER_PARAMETERS",
                  59: "CONNECT_GET_HOSTNAME",
                  60: "CONNECT_SUPPORTS_FEATURE",
                  61: "DOMAIN_MIGRATE_PREPARE",
                  62: "DOMAIN_MIGRATE_PERFORM",
                  63: "DOMAIN_MIGRATE_FINISH",
                  64: "DOMAIN_BLOCK_STATS",
                  65: "DOMAIN_INTERFACE_STATS",
                  66: "AUTH_LIST",
                  67: "AUTH_SASL_INIT",
                  68: "AUTH_SASL_START",
                  69: "AUTH_SASL_STEP",
                  70: "AUTH_POLKIT",
                  71: "CONNECT_NUM_OF_STORAGE_POOLS",
                  72: "CONNECT_LIST_STORAGE_POOLS",
                  73: "CONNECT_NUM_OF_DEFINED_STORAGE_POOLS",
                  74: "CONNECT_LIST_DEFINED_STORAGE_POOLS",
                  75: "CONNECT_FIND_STORAGE_POOL_SOURCES",
                  76: "STORAGE_POOL_CREATE_XML",
                  77: "STORAGE_POOL_DEFINE_XML",
                  78: "STORAGE_POOL_CREATE",
                  79: "STORAGE_POOL_BUILD",
                  80: "STORAGE_POOL_DESTROY",
                  81: "STORAGE_POOL_DELETE",
                  82: "STORAGE_POOL_UNDEFINE",
                  83: "STORAGE_POOL_REFRESH",
                  84: "STORAGE_POOL_LOOKUP_BY_NAME",
                  85: "STORAGE_POOL_LOOKUP_BY_UUID",
                  86: "STORAGE_POOL_LOOKUP_BY_VOLUME",
                  87: "STORAGE_POOL_GET_INFO",
                  88: "STORAGE_POOL_GET_XML_DESC",
                  89: "STORAGE_POOL_GET_AUTOSTART",
                  90: "STORAGE_POOL_SET_AUTOSTART",
                  91: "STORAGE_POOL_NUM_OF_VOLUMES",
                  92: "STORAGE_POOL_LIST_VOLUMES",
                  93: "STORAGE_VOL_CREATE_XML",
                  94: "STORAGE_VOL_DELETE",
                  95: "STORAGE_VOL_LOOKUP_BY_NAME",
                  96: "STORAGE_VOL_LOOKUP_BY_KEY",
                  97: "STORAGE_VOL_LOOKUP_BY_PATH",
                  98: "STORAGE_VOL_GET_INFO",
                  99: "STORAGE_VOL_GET_XML_DESC",
                  100: "STORAGE_VOL_GET_PATH",
                  101: "NODE_GET_CELLS_FREE_MEMORY",
                  102: "NODE_GET_FREE_MEMORY",
                  103: "DOMAIN_BLOCK_PEEK",
                  104: "DOMAIN_MEMORY_PEEK",
                  105: "CONNECT_DOMAIN_EVENT_REGISTER",
                  106: "CONNECT_DOMAIN_EVENT_DEREGISTER",
                  107: "DOMAIN_EVENT_LIFECYCLE",
                  108: "DOMAIN_MIGRATE_PREPARE2",
                  109: "DOMAIN_MIGRATE_FINISH2",
                  110: "CONNECT_GET_URI",
                  111: "NODE_NUM_OF_DEVICES",
                  112: "NODE_LIST_DEVICES",
                  113: "NODE_DEVICE_LOOKUP_BY_NAME",
                  114: "NODE_DEVICE_GET_XML_DESC",
                  115: "NODE_DEVICE_GET_PARENT",
                  116: "NODE_DEVICE_NUM_OF_CAPS",
                  117: "NODE_DEVICE_LIST_CAPS",
                  118: "NODE_DEVICE_DETTACH",
                  119: "NODE_DEVICE_RE_ATTACH",
                  120: "NODE_DEVICE_RESET",
                  121: "DOMAIN_GET_SECURITY_LABEL",
                  122: "NODE_GET_SECURITY_MODEL",
                  123: "NODE_DEVICE_CREATE_XML",
                  124: "NODE_DEVICE_DESTROY",
                  125: "STORAGE_VOL_CREATE_XML_FROM",
                  126: "CONNECT_NUM_OF_INTERFACES",
                  127: "CONNECT_LIST_INTERFACES",
                  128: "INTERFACE_LOOKUP_BY_NAME",
                  129: "INTERFACE_LOOKUP_BY_MAC_STRING",
                  130: "INTERFACE_GET_XML_DESC",
                  131: "INTERFACE_DEFINE_XML",
                  132: "INTERFACE_UNDEFINE",
                  133: "INTERFACE_CREATE",
                  134: "INTERFACE_DESTROY",
                  135: "CONNECT_DOMAIN_XML_FROM_NATIVE",
                  136: "CONNECT_DOMAIN_XML_TO_NATIVE",
                  137: "CONNECT_NUM_OF_DEFINED_INTERFACES",
                  138: "CONNECT_LIST_DEFINED_INTERFACES",
                  139: "CONNECT_NUM_OF_SECRETS",
                  140: "CONNECT_LIST_SECRETS",
                  141: "SECRET_LOOKUP_BY_UUID",
                  142: "SECRET_DEFINE_XML",
                  143: "SECRET_GET_XML_DESC",
                  144: "SECRET_SET_VALUE",
                  145: "SECRET_GET_VALUE",
                  146: "SECRET_UNDEFINE",
                  147: "SECRET_LOOKUP_BY_USAGE",
                  148: "DOMAIN_MIGRATE_PREPARE_TUNNEL",
                  149: "CONNECT_IS_SECURE",
                  150: "DOMAIN_IS_ACTIVE",
                  151: "DOMAIN_IS_PERSISTENT",
                  152: "NETWORK_IS_ACTIVE",
                  153: "NETWORK_IS_PERSISTENT",
                  154: "STORAGE_POOL_IS_ACTIVE",
                  155: "STORAGE_POOL_IS_PERSISTENT",
                  156: "INTERFACE_IS_ACTIVE",
                  157: "CONNECT_GET_LIB_VERSION",
                  158: "CONNECT_COMPARE_CPU",
                  159: "DOMAIN_MEMORY_STATS",
                  160: "DOMAIN_ATTACH_DEVICE_FLAGS",
                  161: "DOMAIN_DETACH_DEVICE_FLAGS",
                  162: "CONNECT_BASELINE_CPU",
                  163: "DOMAIN_GET_JOB_INFO",
                  164: "DOMAIN_ABORT_JOB",
                  165: "STORAGE_VOL_WIPE",
                  166: "DOMAIN_MIGRATE_SET_MAX_DOWNTIME",
                  167: "CONNECT_DOMAIN_EVENT_REGISTER_ANY",
                  168: "CONNECT_DOMAIN_EVENT_DEREGISTER_ANY",
                  169: "DOMAIN_EVENT_REBOOT",
                  170: "DOMAIN_EVENT_RTC_CHANGE",
                  171: "DOMAIN_EVENT_WATCHDOG",
                  172: "DOMAIN_EVENT_IO_ERROR",
                  173: "DOMAIN_EVENT_GRAPHICS",
                  174: "DOMAIN_UPDATE_DEVICE_FLAGS",
                  175: "NWFILTER_LOOKUP_BY_NAME",
                  176: "NWFILTER_LOOKUP_BY_UUID",
                  177: "NWFILTER_GET_XML_DESC",
                  178: "CONNECT_NUM_OF_NWFILTERS",
                  179: "CONNECT_LIST_NWFILTERS",
                  180: "NWFILTER_DEFINE_XML",
                  181: "NWFILTER_UNDEFINE",
                  182: "DOMAIN_MANAGED_SAVE",
                  183: "DOMAIN_HAS_MANAGED_SAVE_IMAGE",
                  184: "DOMAIN_MANAGED_SAVE_REMOVE",
                  185: "DOMAIN_SNAPSHOT_CREATE_XML",
                  186: "DOMAIN_SNAPSHOT_GET_XML_DESC",
                  187: "DOMAIN_SNAPSHOT_NUM",
                  188: "DOMAIN_SNAPSHOT_LIST_NAMES",
                  189: "DOMAIN_SNAPSHOT_LOOKUP_BY_NAME",
                  190: "DOMAIN_HAS_CURRENT_SNAPSHOT",
                  191: "DOMAIN_SNAPSHOT_CURRENT",
                  192: "DOMAIN_REVERT_TO_SNAPSHOT",
                  193: "DOMAIN_SNAPSHOT_DELETE",
                  194: "DOMAIN_GET_BLOCK_INFO",
                  195: "DOMAIN_EVENT_IO_ERROR_REASON",
                  196: "DOMAIN_CREATE_WITH_FLAGS",
                  197: "DOMAIN_SET_MEMORY_PARAMETERS",
                  198: "DOMAIN_GET_MEMORY_PARAMETERS",
                  199: "DOMAIN_SET_VCPUS_FLAGS",
                  200: "DOMAIN_GET_VCPUS_FLAGS",
                  201: "DOMAIN_OPEN_CONSOLE",
                  202: "DOMAIN_IS_UPDATED",
                  203: "CONNECT_GET_SYSINFO",
                  204: "DOMAIN_SET_MEMORY_FLAGS",
                  205: "DOMAIN_SET_BLKIO_PARAMETERS",
                  206: "DOMAIN_GET_BLKIO_PARAMETERS",
                  207: "DOMAIN_MIGRATE_SET_MAX_SPEED",
                  208: "STORAGE_VOL_UPLOAD",
                  209: "STORAGE_VOL_DOWNLOAD",
                  210: "DOMAIN_INJECT_NMI",
                  211: "DOMAIN_SCREENSHOT",
                  212: "DOMAIN_GET_STATE",
                  213: "DOMAIN_MIGRATE_BEGIN3",
                  214: "DOMAIN_MIGRATE_PREPARE3",
                  215: "DOMAIN_MIGRATE_PREPARE_TUNNEL3",
                  216: "DOMAIN_MIGRATE_PERFORM3",
                  217: "DOMAIN_MIGRATE_FINISH3",
                  218: "DOMAIN_MIGRATE_CONFIRM3",
                  219: "DOMAIN_SET_SCHEDULER_PARAMETERS_FLAGS",
                  220: "INTERFACE_CHANGE_BEGIN",
                  221: "INTERFACE_CHANGE_COMMIT",
                  222: "INTERFACE_CHANGE_ROLLBACK",
                  223: "DOMAIN_GET_SCHEDULER_PARAMETERS_FLAGS",
                  224: "DOMAIN_EVENT_CONTROL_ERROR",
                  225: "DOMAIN_PIN_VCPU_FLAGS",
                  226: "DOMAIN_SEND_KEY",
                  227: "NODE_GET_CPU_STATS",
                  228: "NODE_GET_MEMORY_STATS",
                  229: "DOMAIN_GET_CONTROL_INFO",
                  230: "DOMAIN_GET_VCPU_PIN_INFO",
                  231: "DOMAIN_UNDEFINE_FLAGS",
                  232: "DOMAIN_SAVE_FLAGS",
                  233: "DOMAIN_RESTORE_FLAGS",
                  234: "DOMAIN_DESTROY_FLAGS",
                  235: "DOMAIN_SAVE_IMAGE_GET_XML_DESC",
                  236: "DOMAIN_SAVE_IMAGE_DEFINE_XML",
                  237: "DOMAIN_BLOCK_JOB_ABORT",
                  238: "DOMAIN_GET_BLOCK_JOB_INFO",
                  239: "DOMAIN_BLOCK_JOB_SET_SPEED",
                  240: "DOMAIN_BLOCK_PULL",
                  241: "DOMAIN_EVENT_BLOCK_JOB",
                  242: "DOMAIN_MIGRATE_GET_MAX_SPEED",
                  243: "DOMAIN_BLOCK_STATS_FLAGS",
                  244: "DOMAIN_SNAPSHOT_GET_PARENT",
                  245: "DOMAIN_RESET",
                  246: "DOMAIN_SNAPSHOT_NUM_CHILDREN",
                  247: "DOMAIN_SNAPSHOT_LIST_CHILDREN_NAMES",
                  248: "DOMAIN_EVENT_DISK_CHANGE",
                  249: "DOMAIN_OPEN_GRAPHICS",
                  250: "NODE_SUSPEND_FOR_DURATION",
                  251: "DOMAIN_BLOCK_RESIZE",
                  252: "DOMAIN_SET_BLOCK_IO_TUNE",
                  253: "DOMAIN_GET_BLOCK_IO_TUNE",
                  254: "DOMAIN_SET_NUMA_PARAMETERS",
                  255: "DOMAIN_GET_NUMA_PARAMETERS",
                  256: "DOMAIN_SET_INTERFACE_PARAMETERS",
                  257: "DOMAIN_GET_INTERFACE_PARAMETERS",
                  258: "DOMAIN_SHUTDOWN_FLAGS",
                  259: "STORAGE_VOL_WIPE_PATTERN",
                  260: "STORAGE_VOL_RESIZE",
                  261: "DOMAIN_PM_SUSPEND_FOR_DURATION",
                  262: "DOMAIN_GET_CPU_STATS",
                  263: "DOMAIN_GET_DISK_ERRORS",
                  264: "DOMAIN_SET_METADATA",
                  265: "DOMAIN_GET_METADATA",
                  266: "DOMAIN_BLOCK_REBASE",
                  267: "DOMAIN_PM_WAKEUP",
                  268: "DOMAIN_EVENT_TRAY_CHANGE",
                  269: "DOMAIN_EVENT_PMWAKEUP",
                  270: "DOMAIN_EVENT_PMSUSPEND",
                  271: "DOMAIN_SNAPSHOT_IS_CURRENT",
                  272: "DOMAIN_SNAPSHOT_HAS_METADATA",
                  273: "CONNECT_LIST_ALL_DOMAINS",
                  274: "DOMAIN_LIST_ALL_SNAPSHOTS",
                  275: "DOMAIN_SNAPSHOT_LIST_ALL_CHILDREN",
                  276: "DOMAIN_EVENT_BALLOON_CHANGE",
                  277: "DOMAIN_GET_HOSTNAME",
                  278: "DOMAIN_GET_SECURITY_LABEL_LIST",
                  279: "DOMAIN_PIN_EMULATOR",
                  280: "DOMAIN_GET_EMULATOR_PIN_INFO",
                  281: "CONNECT_LIST_ALL_STORAGE_POOLS",
                  282: "STORAGE_POOL_LIST_ALL_VOLUMES",
                  283: "CONNECT_LIST_ALL_NETWORKS",
                  284: "CONNECT_LIST_ALL_INTERFACES",
                  285: "CONNECT_LIST_ALL_NODE_DEVICES",
                  286: "CONNECT_LIST_ALL_NWFILTERS",
                  287: "CONNECT_LIST_ALL_SECRETS",
                  288: "NODE_SET_MEMORY_PARAMETERS",
                  289: "NODE_GET_MEMORY_PARAMETERS",
                  290: "DOMAIN_BLOCK_COMMIT",
                  291: "NETWORK_UPDATE",
                  292: "DOMAIN_EVENT_PMSUSPEND_DISK",
                  293: "NODE_GET_CPU_MAP",
                  294: "DOMAIN_FSTRIM",
                  295: "DOMAIN_SEND_PROCESS_SIGNAL",
                  296: "DOMAIN_OPEN_CHANNEL",
                  297: "NODE_DEVICE_LOOKUP_SCSI_HOST_BY_WWN",
                  298: "DOMAIN_GET_JOB_STATS",
                  299: "DOMAIN_MIGRATE_GET_COMPRESSION_CACHE",
                  300: "DOMAIN_MIGRATE_SET_COMPRESSION_CACHE",
                  301: "NODE_DEVICE_DETACH_FLAGS",
                  302: "DOMAIN_MIGRATE_BEGIN3_PARAMS",
                  303: "DOMAIN_MIGRATE_PREPARE3_PARAMS",
                  304: "DOMAIN_MIGRATE_PREPARE_TUNNEL3_PARAMS",
                  305: "DOMAIN_MIGRATE_PERFORM3_PARAMS",
                  306: "DOMAIN_MIGRATE_FINISH3_PARAMS",
                  307: "DOMAIN_MIGRATE_CONFIRM3_PARAMS",
                  308: "DOMAIN_SET_MEMORY_STATS_PERIOD",
                  309: "DOMAIN_CREATE_XML_WITH_FILES",
                  310: "DOMAIN_CREATE_WITH_FILES",
                  311: "DOMAIN_EVENT_DEVICE_REMOVED",
                  312: "CONNECT_GET_CPU_MODEL_NAMES",
                  313: "CONNECT_NETWORK_EVENT_REGISTER_ANY",
                  314: "CONNECT_NETWORK_EVENT_DEREGISTER_ANY",
                  315: "NETWORK_EVENT_LIFECYCLE",
                  316: "CONNECT_DOMAIN_EVENT_CALLBACK_REGISTER_ANY",
                  317: "CONNECT_DOMAIN_EVENT_CALLBACK_DEREGISTER_ANY",
                  318: "DOMAIN_EVENT_CALLBACK_LIFECYCLE",
                  319: "DOMAIN_EVENT_CALLBACK_REBOOT",
                  320: "DOMAIN_EVENT_CALLBACK_RTC_CHANGE",
                  321: "DOMAIN_EVENT_CALLBACK_WATCHDOG",
                  322: "DOMAIN_EVENT_CALLBACK_IO_ERROR",
                  323: "DOMAIN_EVENT_CALLBACK_GRAPHICS",
                  324: "DOMAIN_EVENT_CALLBACK_IO_ERROR_REASON",
                  325: "DOMAIN_EVENT_CALLBACK_CONTROL_ERROR",
                  326: "DOMAIN_EVENT_CALLBACK_BLOCK_JOB",
                  327: "DOMAIN_EVENT_CALLBACK_DISK_CHANGE",
                  328: "DOMAIN_EVENT_CALLBACK_TRAY_CHANGE",
                  329: "DOMAIN_EVENT_CALLBACK_PMWAKEUP",
                  330: "DOMAIN_EVENT_CALLBACK_PMSUSPEND",
                  331: "DOMAIN_EVENT_CALLBACK_BALLOON_CHANGE",
                  332: "DOMAIN_EVENT_CALLBACK_PMSUSPEND_DISK",
                  333: "DOMAIN_EVENT_CALLBACK_DEVICE_REMOVED",
                  334: "DOMAIN_CORE_DUMP_WITH_FORMAT",
                  335: "DOMAIN_FSFREEZE",
                  336: "DOMAIN_FSTHAW",
                  337: "DOMAIN_GET_TIME",
                  338: "DOMAIN_SET_TIME",
                  339: "DOMAIN_EVENT_BLOCK_JOB_2",
                  340: "NODE_GET_FREE_PAGES",
                  341: "NETWORK_GET_DHCP_LEASES",
                  342: "CONNECT_GET_DOMAIN_CAPABILITIES",
                  343: "DOMAIN_OPEN_GRAPHICS_FD",
                  344: "CONNECT_GET_ALL_DOMAIN_STATS",
                  345: "DOMAIN_BLOCK_COPY",
                  346: "DOMAIN_EVENT_CALLBACK_TUNABLE",
                  347: "NODE_ALLOC_PAGES",
                  348: "DOMAIN_EVENT_CALLBACK_AGENT_LIFECYCLE",
                  349: "DOMAIN_GET_FSINFO",
                  350: "DOMAIN_DEFINE_XML_FLAGS",
                  351: "DOMAIN_GET_IOTHREAD_INFO",
                  352: "DOMAIN_PIN_IOTHREAD",
                  353: "DOMAIN_INTERFACE_ADDRESSES",
                  354: "DOMAIN_EVENT_CALLBACK_DEVICE_ADDED",
                  355: "DOMAIN_ADD_IOTHREAD",
                  356: "DOMAIN_DEL_IOTHREAD",
                  357: "DOMAIN_SET_USER_PASSWORD",
                  358: "DOMAIN_RENAME",
                  359: "DOMAIN_EVENT_CALLBACK_MIGRATION_ITERATION",
                  360: "CONNECT_REGISTER_CLOSE_CALLBACK",
                  361: "CONNECT_UNREGISTER_CLOSE_CALLBACK",
                  362: "CONNECT_EVENT_CONNECTION_CLOSED",
                  363: "DOMAIN_EVENT_CALLBACK_JOB_COMPLETED",
                  364: "DOMAIN_MIGRATE_START_POST_COPY",
                  365: "DOMAIN_GET_PERF_EVENTS",
                  366: "DOMAIN_SET_PERF_EVENTS",
                  367: "DOMAIN_EVENT_CALLBACK_DEVICE_REMOVAL_FAILED",
                  368: "CONNECT_STORAGE_POOL_EVENT_REGISTER_ANY",
                  369: "CONNECT_STORAGE_POOL_EVENT_DEREGISTER_ANY",
                  370: "STORAGE_POOL_EVENT_LIFECYCLE",
                  371: "DOMAIN_GET_GUEST_VCPUS",
                  372: "DOMAIN_SET_GUEST_VCPUS",
                  373: "STORAGE_POOL_EVENT_REFRESH",
                  374: "CONNECT_NODE_DEVICE_EVENT_REGISTER_ANY",
                  375: "CONNECT_NODE_DEVICE_EVENT_DEREGISTER_ANY",
                  376: "NODE_DEVICE_EVENT_LIFECYCLE",
                  377: "NODE_DEVICE_EVENT_UPDATE",
                  378: "STORAGE_VOL_GET_INFO_FLAGS",
                  379: "DOMAIN_EVENT_CALLBACK_METADATA_CHANGE",
                  380: "CONNECT_SECRET_EVENT_REGISTER_ANY",
                  381: "CONNECT_SECRET_EVENT_DEREGISTER_ANY",
                  382: "SECRET_EVENT_LIFECYCLE",
                  383: "SECRET_EVENT_VALUE_CHANGED",
                  384: "DOMAIN_SET_VCPU",
                  385: "DOMAIN_EVENT_BLOCK_THRESHOLD",
                  386: "DOMAIN_SET_BLOCK_THRESHOLD",
                  387: "DOMAIN_MIGRATE_GET_MAX_DOWNTIME",
                  388: "DOMAIN_MANAGED_SAVE_GET_XML_DESC",
                  389: "DOMAIN_MANAGED_SAVE_DEFINE_XML",
                  390: "DOMAIN_SET_LIFECYCLE_ACTION",
                  391: "STORAGE_POOL_LOOKUP_BY_TARGET_PATH"}


class Libvirt(Packet):
    name = 'Libvirt Packet'
    fields_desc = [ShortField('len', None),
                   ShortField('program', 1),
                   ByteEnumField('procedure', 4, procedure_dict),
                   ByteEnumField(
                       "type", 4, {1: "CALL", 2: "REPLY", 3: "EVENT", 4: "STREAM"}),
                   ShortField('serial', 1),
                   ByteEnumField('status', 4, {1: "OK", 2: "ERROR", 3: "CONTINUE"})]
